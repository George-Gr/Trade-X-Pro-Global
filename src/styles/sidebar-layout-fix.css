/* Sidebar layout fixes
   Purpose: Ensures the sidebar is fixed to the left side of the screen,
   stays in place during scrolling, and properly integrates with the main layout.
   Handles both expanded and collapsed states with smooth transitions. */

/* Ensure sidebar background and foreground use design tokens */
.sidebar,
.app-sidebar,
[data-sidebar="sidebar"] {
  background-color: hsl(var(--sidebar));
  color: hsl(var(--sidebar-foreground));
  border-color: hsl(var(--sidebar-border));
}

/* Smooth, performant transitions for show/hide and theme changes */
.sidebar,
.sidebar * {
  transition: background-color var(--transition-fast),
              color var(--transition-fast),
              transform var(--transition-fast);
  will-change: transform, opacity;
}

/* Fix for mobile: ensure sidebar uses full height and scrolls internally */
.sidebar {
  max-height: 100vh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* Accessibility: high contrast border when focused */
.sidebar:focus-within {
  box-shadow: 0 0 0 3px hsl(var(--sidebar-ring) / 0.18);
}

/* Small tweak to avoid flicker on theme inversion in Safari/Chromium */
@media (prefers-reduced-motion: no-preference) {
  .sidebar { backface-visibility: hidden; }
  [data-sidebar="sidebar"] { backface-visibility: hidden; }
}

/* Ensure header stays above sidebar with proper z-index */
header[class*="sticky"] {
  z-index: 40;
}

/* Support for collapsed sidebar width transitions on desktop */
@media (min-width: 768px) {
  /* Sidebar peer selector for state-based transitions */
  .group.peer[data-state="expanded"] ~ * {
    margin-left: var(--sidebar-width, 16rem);
    transition: margin-left 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* When sidebar is collapsed with icon variant, reduce margin */
  .group.peer[data-state="collapsed"] ~ * {
    margin-left: var(--sidebar-width-icon, 4rem);
    transition: margin-left 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Ensure proper spacing for offcanvas collapsible variant */
  .group.peer[data-state="collapsed"][data-collapsible="offcanvas"] ~ * {
    margin-left: 0;
  }
}
